/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var Well = ee.FeatureCollection("ft:1Rto8ImdBnuDcBNX-ApGkuSfZf7UetvXjjFPc6RAu"),
    geometry = /* color: #bf04c2 */ee.Geometry.Point([-95.93974113464355, 30.11038488561688]),
    shaleplay = ee.FeatureCollection("ft:1EIjMHaQqs6SGoIdocVDIQJfFQXVwVKr4tbOgpy6c"),
    conventional_play = ee.FeatureCollection("ft:1BUaXMmhXABk8pnXRBvWZnHVbQcPx5TQE74qVU2jG");
/***** End of imports. If edited, may not auto-convert in the playground. *****/

// Color scheme 
var db= ('0000FF').toString();
var lb= ('#11ffff').toString();
var bl = ('#538dd6').toString();
var red=('ff510f').toString();
var lr = ('#ff8f7d').toString();
var gr= ('#4cff62').toString();
var lg = ('#afff14').toString();
var dg= ('#196e0a').toString();
var yellow=('#ffeb00').toString();
var whi=('#f7f7f7').toString();
var black = ('#101010').toString();
var pink = ('#ff50f1').toString();
var orange = ('#ff9d24').toString();
var lorange = ('#ffcc99').toString();
var lyellow = ('#fffcb0').toString();

Map.addLayer(conventional_play, {'color':lorange}, "conventional_play", 1, 1); 
Map.addLayer(shaleplay, {'color':black}, "shale play boundaries"); 



//select wells of certaint atrributes 
// Directional wells whose First Production Date is after the 2000s
var H_post2000 = Well
.filterMetadata('First Prod Date','greater_than', ee.Date('2000-01-01').millis())
.filterMetadata("Drill Type","equals","H"); 

// Directional wells whose First Production Date is before the 2000s
var H_pre2000 = Well
.filterMetadata('First Prod Date','less_than', ee.Date('2000-01-01').millis())
.filterMetadata("Drill Type","equals","H"); 

var U_post2000 = Well
.filterMetadata('First Prod Date','greater_than', ee.Date('2000-01-01').millis())
.filterMetadata("Drill Type","equals","U");

var U_pre2000 = Well
.filterMetadata('First Prod Date','less_than', ee.Date('2000-01-01').millis())
.filterMetadata("Drill Type","equals","U");




 
//view horizontal wells with early dates 
var D_wells = Well
.filter(ee.Filter.inList('Updated Production Type',  ['GAS', 'O&G', 'OIL']))
.filterMetadata("Drill Type","equals","D"); 

var V_wells = Well
.filter(ee.Filter.inList('Updated Production Type',  ['GAS', 'O&G', 'OIL']))
.filterMetadata("Drill Type","equals","V"); 



var Well_List = ee.List([D_wells,V_wells, H_post2000, H_pre2000,U_post2000, U_pre2000 ]); 
var Well_List_names = ee.List(["D_wells", "V_wells", 'H_post2000', 'H_pre2000','U_post2000', 'U_pre2000']);



//center on Geometry on the map
Map.centerObject(geometry, 5);

// add Layers 
// Map.addLayer(V_wells, {'color':pink}, "V_wells", 1, 0.3); 
// Map.addLayer(D_wells, {'color':lb}, "D_wells",1, 0.3); 
// Map.addLayer(H_post2000, {'color':yellow}, "H_post2000"); 
// Map.addLayer(H_pre2000, {'color':db}, "H_pre2000"); 

// Map.addLayer(U_pre2000, {'color':dg}, "U_pre2000", 1, 0.4); 
// Map.addLayer(U_post2000, {'color':lg}, "U_post2000", 1, 0.4); 



// count number of wells 
var well_count = function(fc){
  fc = ee.FeatureCollection(fc);
  var output = fc.aggregate_sum('Well Count');
  return ee.Number(output);
};

var count = Well_List.map(well_count);
print('Total well count by type'); print(Well_List_names.zip(count));

var spatialFilter = ee.Filter.intersects({
  leftField: '.geo',
  rightField: '.geo',
  maxError: 10
});

// Define a save all join.
var saveAllJoin = ee.Join.saveAll({
  matchesKey: 'scenes',
});
var intersectJoined = saveAllJoin.apply( H_pre2000,shaleplay, spatialFilter);
print(intersectJoined);
var intersected = ee.FeatureCollection(ee.List(intersectJoined.first().get('scenes')));
print(intersected);
Map.addLayer(intersectJoined, {}, 'intersectJoined');
Map.addLayer(intersected, {}, 'intersected');


Map.addLayer(intersectJoined, {'color':yellow}, "H_post2000"); 
Map.addLayer(H_pre2000, {'color':db}, "H_pre2000"); 



















//

// var convert_to_image = function(plays){
//   plays = ee.Feature(plays);
//   var result= plays.reduceToImage(
//     {properties:['geometry_vertex_count'],
//     reducer:ee.Reducer.first()}
//     );
//   return(ee.Image(result));
// };


// var image_shaleplay = shaleplay.map(convert_to_image);

// var image_shaleplay =shaleplay.reduceToImage(
//     {properties:['geometry_vertex_count'],
//     reducer:ee.Reducer.first()}
//     );
    
// var convert_shale = function(fc){
//   fc = ee.FeatureCollection(fc);
//   var image = fc.reduceToImage(
//     {properties:['geometry_vertex_count'],reducer:ee.Reducer.first()}
//     );
//   image = image.subtract(image).add(1);
//   return(image);
// };
// var convert_to_multiple_images_shaleplay = shaleplay.map(convert_shale);


// var shaleplay_again = image_shaleplay.reduceToVectors(
  
//   );
// print(shaleplay_again);
// image_shaleplay = image_shaleplay.subtract(image_shaleplay).add(1);
// Map.addLayer(image_shaleplay);
// // Map.addLayer(image_shaleplay.geometry().bounds());


// var count = image_shaleplay.reduceRegion({
//   reducer: ee.Reducer.sum(),
//   geometry: V_wells,
//   scale: 100
//   });
  
// print(count.getInfo());